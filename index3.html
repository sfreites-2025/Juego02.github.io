<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Juego del Laberinto - Niveles</title>
<style>
  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(125deg, #37474f, #263238, #212121);
    color: #eceff1;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
  }

  h1 {
    margin-top: 40px;
    font-size: 2.8em;
    text-shadow: 0 0 6px #81d4fa;
  }

  #level-bar {
    margin: 25px 0 15px 0;
    display: flex;
    gap: 12px;
  }

  .level-btn {
    background: #0288d1;
    border: none;
    padding: 10px 26px;
    border-radius: 16px;
    font-weight: 700;
    font-size: 1.1em;
    color: white;
    cursor: pointer;
    box-shadow: 0 5px 15px #0288d155;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  .level-btn:hover, .level-btn.selected {
    background: #81d4fa;
    color: #37474f;
    transform: scale(1.1);
    box-shadow: 0 6px 25px #81d4fa99;
  }

  #stats-bar {
    margin-bottom: 20px;
    font-size: 1.2em;
    font-weight: bold;
    letter-spacing: 0.4px;
    text-shadow: 0 0 12px #0277bdbb;
  }

  #maze {
    position: relative;
    background: #263238;
    border: 3px solid #81d4fa;
    overflow: hidden;
    box-shadow: 0 0 12px #81d4faaa;
  }

  /* Maze cells */
  .maze-cell {
    float: left;
    box-sizing: border-box;
    border: 1px solid #37474f;
    width: 35px;
    height: 35px;
    transition: background-color 0.3s ease;
  }
  .wall {
    background-color: #1c1f23;
  }
  .path {
    background-color: #263238;
  }
  .player {
    background-color: #29b6f6;
    box-shadow: 0 0 10px 2px #29b6f6, inset 0 0 7px 2px #82cfff;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
  }
  .goal {
    background-color: #ffd740;
    box-shadow: 0 0 12px 4px #ffd740cc, inset 0 0 9px 3px #ffe740;
    animation: glowGoal 2s infinite alternate;
  }

  @keyframes glowGoal {
    0% { box-shadow: 0 0 12px 4px #ffd740cc, inset 0 0 9px 3px #ffe740; }
    100% { box-shadow: 0 0 25px 7px #ffd740ff, inset 0 0 15px 5px #fff176; }
  }

  #msg {
    font-size: 1.4em;
    font-weight: 700;
    color: #ff7043;
    margin: 14px 0 22px 0;
    min-height: 30px;
    text-shadow: 0 0 12px #ffab91cc;
  }

  #reset-btn {
    background-color: #29b6f6;
    border: none;
    padding: 13px 28px;
    border-radius: 16px;
    font-weight: 700;
    font-size: 1.1em;
    color: #263238;
    box-shadow: 0 6px 16px #29b6f655;
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  #reset-btn:hover {
    background-color: #81d4fa;
    color: #212121;
    box-shadow: 0 10px 30px #81d4faaa;
  }

  #back-btn {
    position: fixed;
    top: 18px;
    left: 18px;
    background: #0288d1cc;
    border: none;
    color: #ffd740;
    font-weight: 700;
    padding: 10px 26px;
    border-radius: 50px;
    font-size: 1.05em;
    cursor: pointer;
    box-shadow: 0 0 12px #4fc3f7a6;
    transition: background-color 0.25s;
    z-index: 9999;
  }
  #back-btn:hover {
    background: #029beaff;
    color: white;
  }

  /* Clear floats */
  #maze::after {
    content: "";
    display: block;
    clear: both;
  }
</style>
</head>
<body>

<button id="back-btn" onclick="location.href='index.html'">‚Üê Men√∫ principal</button>
<h1>Juego del Laberinto</h1>

<div id="level-bar">
  <button class="level-btn selected" data-level="1">Nivel 1</button>
  <button class="level-btn" data-level="2">Nivel 2</button>
  <button class="level-btn" data-level="3">Nivel 3</button>
  <button class="level-btn" data-level="4">Nivel 4</button>
  <button class="level-btn" data-level="5">Nivel 5</button>
</div>

<div id="stats-bar">
  Movimientos: <span id="moves-taken">0</span>
</div>

<div id="maze"></div>

<div id="msg"></div>

<button id="reset-btn">Reiniciar nivel</button>

<script>
  const mazeContainer = document.getElementById('maze');
  const movesSpan = document.getElementById('moves-taken');
  const msg = document.getElementById('msg');
  const resetBtn = document.getElementById('reset-btn');
  const levelButtons = document.querySelectorAll('.level-btn');

  let level = 1;
  let moves = 0;
  let mazeGrid = [];
  let playerPos = {x: 0, y: 0};
  let goalPos = {x: 0, y: 0};
  let mazeSize = 8;
  let mazeData = [];
  let canMove = true;

  // Maze layouts by level. 1 = wall, 0 = path
  // Maze maps created to increase size / difficulty, hidden path by color
  const mazes = [
    [ // Level 1: 8x8
      [1,1,1,1,1,1,1,1],
      [1,0,0,0,1,0,0,1],
      [1,0,1,0,1,0,1,1],
      [1,0,1,0,0,0,0,1],
      [1,0,1,1,1,1,0,1],
      [1,0,0,0,0,1,0,1],
      [1,1,1,1,0,1,0,1],
      [1,1,1,1,1,1,1,1],
    ],
    [ // Level 2: 10x10
      [1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,1,0,0,0,0,1],
      [1,0,1,0,1,0,1,1,0,1],
      [1,0,1,0,0,0,0,1,0,1],
      [1,0,1,1,1,1,0,1,0,1],
      [1,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,0,1,0,1,0,1],
      [1,0,0,1,0,0,0,0,0,1],
      [1,0,0,0,1,1,1,1,0,1],
      [1,1,1,1,1,1,1,1,1,1],
    ],
    [ // Level 3: 12x12
      [1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,1,0,0,0,0,0,0,1],
      [1,0,1,0,1,0,1,1,1,1,0,1],
      [1,0,1,0,0,0,0,0,0,1,0,1],
      [1,0,1,1,1,1,1,1,0,1,0,1],
      [1,0,0,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,1,0,1,0,0,0,1],
      [1,0,1,1,0,1,0,1,1,1,0,1],
      [1,0,1,0,0,0,0,0,0,1,0,1],
      [1,0,0,0,1,1,1,1,0,0,0,1],
      [1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    [ // Level 4: 14x14 - harder map with some dead ends and tight corridors
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,1,0,0,0,0,0,0,0,1],
      [1,1,1,1,0,1,0,1,1,1,1,0,1,1],
      [1,0,0,1,0,0,0,1,0,0,1,0,0,1],
      [1,0,1,1,1,1,0,1,0,1,1,1,0,1],
      [1,0,0,0,0,1,0,1,0,0,0,0,0,1],
      [1,1,1,1,0,1,0,1,1,1,1,1,0,1],
      [1,0,0,1,0,1,0,0,0,0,0,1,0,1],
      [1,0,1,1,0,1,1,1,1,1,0,1,0,1],
      [1,0,0,0,0,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,0,0,1,0,0,0,0,0,1],
      [1,0,1,1,1,1,0,1,1,1,1,1,0,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ],
    [ // Nivel 5 corregido: 16x16 con caminos validos y complejos
     [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
     [1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1],
     [1,1,1,0,1,0,1,1,1,1,1,0,1,1,0,1],
     [1,0,1,0,1,0,0,0,0,0,1,0,0,0,0,1],
     [1,0,1,0,1,1,1,1,1,0,1,1,1,1,0,1],
     [1,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1],
     [1,0,1,1,1,1,1,0,1,1,1,1,0,1,0,1],
     [1,0,0,0,0,0,1,0,0,0,0,1,0,1,0,1],
     [1,1,1,1,1,0,1,1,1,1,0,1,0,1,0,1],
     [1,0,0,0,1,0,0,0,1,0,0,1,0,1,0,1],
     [1,0,1,0,1,1,1,0,1,1,0,1,0,1,0,1],
     [1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,1],
     [1,0,1,1,1,0,1,1,1,1,1,1,1,1,0,1],
     [1,0,0,0,1,0,0,0,0,0,0,0,0,1,0,1],
     [1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,1],
     [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    ]

  ];

  // Player starts always near top-left path, goal near bottom-right open cell
  function initLevel(lvl) {
    mazeData = mazes[lvl - 1];
    mazeSize = mazeData.length;
    playerPos = findOpenCell(mazeData, true); // top-left open cell
    goalPos = findOpenCell(mazeData, false); // bottom-right open cell
    moves = 0;
    canMove = true;
    movesSpan.textContent = moves;
    msg.textContent = "";
    createMazeGrid();
    highlightPlayerGoal();
  }

  function findOpenCell(grid, topLeft = true) {
    if (topLeft) {
      for (let y = 0; y < grid.length; y++) {
        for (let x = 0; x < grid.length; x++) {
          if (grid[y][x] === 0) return {x, y};
        }
      }
    } else {
      for (let y = grid.length - 1; y >= 0; y--) {
        for (let x = grid.length - 1; x >= 0; x--) {
          if (grid[y][x] === 0) return {x, y};
        }
      }
    }
    // fallback
    return {x: 1, y: 1};
  }

  function createMazeGrid() {
    mazeContainer.innerHTML = '';
    mazeContainer.style.width = `${mazeSize * 37}px`;
    mazeContainer.style.height = `${mazeSize * 37}px`;

    mazeGrid = [];
    for (let y=0; y<mazeSize; y++) {
      for (let x=0; x<mazeSize; x++) {
        const cell = document.createElement('div');
        cell.classList.add('maze-cell');
        if (mazeData[y][x] === 1) {
          cell.classList.add('wall');
        } else {
          cell.classList.add('path');
        }
        mazeContainer.appendChild(cell);
        mazeGrid.push(cell);
      }
    }
  }

  function cellIndex(x, y) {
    return y * mazeSize + x;
  }

  function highlightPlayerGoal() {
    mazeGrid.forEach(cell => {
      cell.classList.remove('player', 'goal');
    });
    mazeGrid[cellIndex(playerPos.x, playerPos.y)].classList.add('player');
    mazeGrid[cellIndex(goalPos.x, goalPos.y)].classList.add('goal');
  }

  function movePlayer(dx, dy) {
    if (!canMove) return;

    let nx = playerPos.x + dx;
    let ny = playerPos.y + dy;

    if (nx < 0 || ny < 0 || nx >= mazeSize || ny >= mazeSize) {
      return;
    }
    if (mazeData[ny][nx] === 1) return;

    // Move player
    mazeGrid[cellIndex(playerPos.x, playerPos.y)].classList.remove('player');
    playerPos.x = nx;
    playerPos.y = ny;

    mazeGrid[cellIndex(nx, ny)].classList.add('player');

    moves++;
    movesSpan.textContent = moves;

    checkGoal();
  }

  function checkGoal() {
    if (playerPos.x === goalPos.x && playerPos.y === goalPos.y) {
      canMove = false;
      msg.textContent = '¬°Felicidades! Nivel completado üéâ';
      setTimeout(() => {
        if (level < 5) {
          startLevel(level + 1);
        } else {
          msg.textContent = '¬°Completaste todos los niveles! üëè';
        }
      }, 1400);
    }
  }

  function startLevel(lvl) {
    level = lvl;
    msg.textContent = '';
    updateLevelButtons();
    initLevel(level);
  }

  function updateLevelButtons() {
    levelButtons.forEach(btn => {
      btn.classList.toggle('selected', parseInt(btn.dataset.level) === level);
    });
  }

  resetBtn.addEventListener('click', () => {
    initLevel(level);
  });

  levelButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      startLevel(parseInt(btn.dataset.level));
    });
  });

  window.addEventListener('keydown', (e) => {
    if (!canMove) return;
    switch(e.key) {
      case 'ArrowUp': e.preventDefault(); movePlayer(0, -1); break;
      case 'ArrowDown': e.preventDefault(); movePlayer(0, 1); break;
      case 'ArrowLeft': e.preventDefault(); movePlayer(-1, 0); break;
      case 'ArrowRight': e.preventDefault(); movePlayer(1, 0); break;
    }
  });

  // Inicia en nivel 1
  startLevel(1);

</script>
</body>
</html>
